name: Upload Test File to Release

on:
  # 触发条件：当有新标签被推送时（例如 v1.0.0）
  workflow_dispatch:

jobs:
  upload-test-file:
    runs-on: ubuntu-latest
    permissions:
      contents: write  # 需要写入 Releases 的权限

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Generate Test File
        run: |
          echo "This is a test file generated by GitHub Action." > test.txt
          echo "Timestamp: $(date)" >> test.txt

      - name: Upload firmware to release
        uses: softprops/action-gh-release@master
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tag_name: test
          body_path: test.txt
          files: test.txt
